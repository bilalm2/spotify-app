(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}})();async function d(e){const t=u(128),r=await m(t);localStorage.setItem("verifier",t);const n=new URLSearchParams;n.append("client_id",e),n.append("response_type","code"),n.append("redirect_uri","https://spotifystats4.netlify.app"),n.append("scope","user-read-private user-read-email user-top-read"),n.append("code_challenge_method","S256"),n.append("code_challenge",r),document.location=`https://accounts.spotify.com/authorize?${n.toString()}`}function u(e){let t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}async function m(e){const t=new TextEncoder().encode(e),r=await window.crypto.subtle.digest("SHA-256",t);return btoa(String.fromCharCode.apply(null,[...new Uint8Array(r)])).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function p(e,t){const r=localStorage.getItem("verifier"),n=new URLSearchParams;n.append("client_id",e),n.append("grant_type","authorization_code"),n.append("code",t),n.append("redirect_uri","https://spotifystats4.netlify.app"),n.append("code_verifier",r);const o=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n}),{access_token:s}=await o.json();return sessionStorage.setItem("access_token",s),s}async function f(e){return await(await fetch("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:`Bearer ${e}`}})).json()}async function g(e){return await(await fetch("https://api.spotify.com/v1/me/top/artists",{method:"GET",headers:{Authorization:`Bearer ${e}`}})).json()}async function h(e){return await(await fetch("https://api.spotify.com/v1/me/top/tracks",{method:"GET",headers:{Authorization:`Bearer ${e}`}})).json()}function y(e){if(a("displayName")&&(document.getElementById("displayName").innerText=e.display_name),e.images[0]){const t=new Image(150,150);t.src=e.images[0].url,a("avatar")&&document.getElementById("avatar").appendChild(t),a("imgUrl")&&(document.getElementById("imgUrl").innerText=e.images[0].url)}a("id")&&(document.getElementById("id").innerText=e.id),a("email")&&(document.getElementById("email").innerText=e.email),a("uri")&&(document.getElementById("uri").innerText=e.uri,document.getElementById("uri").setAttribute("href",e.external_urls.spotify),document.getElementById("url").innerText=e.href,document.getElementById("url").setAttribute("href",e.href))}function a(e){return document.getElementById(e)!==null}function I(e){if(w("Artist1"))for(let t=0;t<5;t++){document.getElementById(`Artist${t+1}`).innerText=e.items[t].name;const r=new Image(60,60);r.src=e.items[t].images[0].url,document.getElementById(`ArtistImage${t+1}`).appendChild(r),document.getElementById(`url${t+1}`).setAttribute("href",e.items[t].external_urls.spotify)}}function w(e){return document.getElementById(e)!==null}function E(e){const t=e.items[0].preview_url;if(T("Track1"))for(let r=0;r<5;r++){document.getElementById(`Track${r+1}`).innerText=e.items[r].name;const n=new Image(60,60);n.src=e.items[r].album.images[0].url,document.getElementById(`TrackImage${r+1}`).appendChild(n),t!==null?document.getElementById(`url${r+1}`).setAttribute("href",t):document.getElementById(`url${r+1}`).setAttribute("href",e.items[0].external_urls.spotify)}}function T(e){return document.getElementById(e)!==null}const c="f8435734ad604359be9029b20de31971",_=new URLSearchParams(window.location.search),l=_.get("code"),B=sessionStorage.getItem("access_token");if(!B)if(!l)await d(c);else{const e=await p(c,l);sessionStorage.setItem("access_token",e)}const A=await f(sessionStorage.getItem("access_token")),x=await g(sessionStorage.getItem("access_token")),S=await h(sessionStorage.getItem("access_token"));y(A);I(x);E(S);
